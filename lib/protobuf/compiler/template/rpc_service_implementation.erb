<%-
module_array = module_name.split('::')
class_indent = '	'*(module_array.size)
-%>
require 'protobuf/rpc/service'
require '<%= required_file %>'

##	!! DO NOT EDIT THIS FILE !!
## 
##	To implement this service as defined by the protobuf,
##	extend <%= module_name %>::<%= service_name %>Impl and implement each service method:
## 
##	module MyApp
##		module Services
## 			class <%= service_name %> < <%= module_name %>::<%= service_name %>Impl
## 
<%- rpcs.each do |name, request, response| -%>
##				service_method :<%= underscore name %> do |request, response|
##					# YOUR CODE HERE
##					# request param mapped to a <%= module_name %>::<%= request %> instance
##					# response param mapped to a <%= module_name %>::<%= response %> instance
##				end
##	 
<%- end -%>
##			end
##		end
##	end
## 

<%- module_array.each_with_index do |m, i| -%>
<%= "#{"\t"*i}module #{m}" %>
<%- end -%>
<%= class_indent %>class <%= service_name %>Impl < Protobuf::Rpc::Service
<%- rpcs.each do |name, request, response| -%>
<%= class_indent %>  proto :<%= underscore name %>, <%= request %>, <%= response %>
<%- end -%>
<%= class_indent %>end
<%- (module_array.size-1).downto(0) do |i| -%>
<%= "#{"\t"*i}end" %>
<%- end -%>
